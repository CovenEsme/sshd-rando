# For any textadd objects, see the text_data folder for what
# the specific text being added is

003-ItemGet:
  - name: Health Trap Entry
    type: entryadd
    entry:
      name: "003_250"
      value: Show Trap Text
  - name: Groose Trap Entry
    type: entryadd
    entry:
      name: "003_251"
      value: Show Trap Text
  - name: Noise Trap Entry
    type: entryadd
    entry:
      name: "003_252"
      value: Show Trap Text
  - name: Curse Trap Entry
    type: entryadd
    entry:
      name: "003_253"
      value: Show Trap Text
  - name: Burn Trap Entry
    type: entryadd
    entry:
      name: "003_254"
      value: Show Trap Text

  - name: Trap Text
    type: textadd
    textboxtype: 5
    unk2: 1
  - name: Show Trap Text
    type: flowadd
    flow:
      type: type1
      next: Give Trap
      param3: 3
      param4: Trap Text
  - name: Give Trap
    type: flowadd
    flow:
      type: type3
      next: -1
      param3: 72 # custom command: give trap

  - name: Patch Rupoor for Traps
    type: flowpatch
    index: 112
    flow:
      next: Check for Trap
  - name: Check for Trap
    type: flowadd
    flow:
      type: type3
      next: Trap Rupoor Switch
      param3: 71 # custom command: get trap id
  - name: Trap Rupoor Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 7 # use result from previous check
    cases:
      - 54 # Rupoor text
      - Show Trap Text

  - name: Scrapper Entry
    type: entryadd
    entry:
      name: "003_215"
      value: Show Scrapper Item Get Text
  - name: Scrapper Item Get Text
    type: textadd
    textboxtype: 5
    unk2: 1
  - name: Show Scrapper Item Get Text
    type: flowadd
    flow:
      type: type1
      next: Give Scrapper Storyflag
      param3: 3
      param4: Scrapper Item Get Text
  - name: Give Scrapper Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 323 # Scrapper Storyflag
      next: Give Sparrot Quest Storyflag
      param3: 0
  - name: Give Sparrot Quest Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 371 # Sparrot Quest Storyflag
      next: Give Dodoh Quest Storyflag
      param3: 0
  - name: Give Dodoh Quest Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 396 # Dodoh Quest Storyflag
      next: Check Pumm Pumpkin Carry Quest Storyflag
      param3: 0
  - name: Check Pumm Pumpkin Carry Quest Storyflag
    type: switchadd
    flow:
      subType: 6
      param2: 293 # Pumm gives Pumpkin Carry Storyflag
      param3: 3
    cases:
      - Give Kina Quest Storyflag
      - Check for Kikwi Elder Storyflag
  - name: Give Kina Quest Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 470 # Kina Storyflag
      next: Check for Kikwi Elder Storyflag
      param3: 0
  - name: Check for Kikwi Elder Storyflag
    type: switchadd
    flow:
      subType: 6
      param2: 898 # Obtained Item from Bucha
      param3: 3
    cases:
      - Give Owlan Quest Storyflag
      - -1
  - name: Give Owlan Quest Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 479 # Started Owlan Quest Storyflag
      next: -1
      param3: 0

  - name: Tadtone Entry
    type: entryadd
    entry:
      name: "003_214"
      value: Increment Tadtone Counter
  - name: Increment Tadtone Counter
    type: flowadd
    flow:
      type: type3
      next: Check for all Tadtones
      param1: 953 # flag
      param2: 1 # increment counter
      param3: 74 # custom command: increment tadtone group counter
  - name: Check for all Tadtones
    type: flowadd
    flow:
      type: type3
      next: Switch for all Tadtones
      param1: 0
      param2: 0
      param3: 75 # custom command: get tadtones groups remaining
  - name: Switch for all Tadtones
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 7 # use result from previous check
    cases:
      - Show all Tadtones Collected text
      - Show some Tadtones Collected text
  - name: Some Tadtones Collected text
    type: textadd
    textboxtype: 5
    unk2: 1
  - name: Show some Tadtones Collected text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 3
      param4: Some Tadtones Collected text
  - name: All Tadtones Collected text
    type: textadd
    textboxtype: 5
    unk2: 1
  - name: Show all Tadtones Collected text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 3
      param4: All Tadtones Collected text

  - name: Spiral Charge Text
    type: textpatch
    index: 27
  - name: Change Spiral Charge Scene change
    type: flowpatch
    index: 584 # change it to give Spiral Charge Storyflag
    flow:
      subType: 0
      param1: 0
      param2: 364
      param3: 0

  - name: Remove Goddess Sword Scene change
    type: flowpatch
    index: 462 # skip scene change after getting goddess sword
    flow:
      next: -1
  - name: Remove bipping after practice sword
    type: flowpatch
    index: 383
    flow:
      next: -1
  - name: Remove Sacred Power of Nayru Scene change (1st part)
    type: flowpatch
    index: 531
    flow:
      next: -1
  - name: Remove Sacred Power of Nayru Scene change (2nd part)
    type: flowpatch
    index: 532
    flow:
      next: -1
  - name: Remove Sacred Power of Farore Scene change (1st part)
    type: flowpatch
    index: 534
    flow:
      next: -1
  - name: Remove Sacred Power of Farore Scene change (2nd part)
    type: flowpatch
    index: 535
    flow:
      next: -1
  - name: Remove Sacred Power of Din Scene change (1st part)
    type: flowpatch
    index: 536
    flow:
      next: -1
  - name: Remove Sacred Power of Din Scene change (2nd part)
    type: flowpatch
    index: 537
    flow:
      next: -1
  - name: Give Dowsings after Whitesword
    type: flowpatch
    index: 542
    flow:
      next: Rupee Dowsing
  - name: Rupee Dowsing
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 105 # Rupee Dowsing
      next: Crystal Dowsing
      param3: 0
  - name: Crystal Dowsing
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 104 # Crystal Dowsing
      next: Treasure Dowsing
      param3: 0
  - name: Treasure Dowsing
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 102 # Treasure Dowsing
      next: Goddess Cube Dowsing
      param3: 0
  - name: Goddess Cube Dowsing
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 110 # Goddess Cube Dowsing
      next: Open Dowsing Wheel
      param3: 0
  - name: Open Dowsing Wheel
    type: flowadd
    flow:
      type: type3
      subType: 6
      param1: 0
      param2: 19 # Crystal blinks
      next: -1
      param3: 56
  - name: Goddess Longsword Text
    type: textpatch
    index: 16
  - name: Goddess White Sword Text
    type: textpatch
    index: 12
  - name: Master Sword Text
    type: textpatch
    index: 17
  - name: True Master Sword Text
    type: textpatch
    index: 19
  - name: Harp Text
    type: textpatch
    index: 21
  - name: Harp Inventory Text
    type: textpatch
    index: 477
  - name: Emerald Tablet text
    type: textpatch
    index: 227
  - name: Ruby Tablet text
    type: textpatch
    index: 228
  - name: Amber Tablet text
    type: textpatch
    index: 229
  - name: Farore's Courage Text
    type: textpatch
    index: 237
  - name: Nayru's Wisdom Text
    type: textpatch
    index: 238
  - name: Din's Power Text
    type: textpatch
    index: 239
  - name: Faron SotH text
    type: textpatch
    index: 240
  - name: Eldin SotH text
    type: textpatch
    index: 241
  - name: Lanayru SotH text
    type: textpatch
    index: 242
  - name: Full SotH text
    type: textpatch
    index: 243
  - name: Cold Pumpkin Soup text
    type: textpatch
    index: 246
  - name: Five Gratitude crystal counter
    type: textpatch
    index: 45
  - name: Single Gratitude crystal counter
    type: textpatch
    index: 62
  - name: Zelda dowsing in Key Piece
    type: flowpatch
    index: 677
    flow:
      next: -1
  - name: remove BotG Scene Change # also goes to open thunderhead
    type: flowpatch
    index: 464
    flow:
      next: Give rando BotG storyflag
  - name: Give rando BotG storyflag
    type: setstoryflag
    flow:
      setstoryflag: 493 # Unlocked Goddess Walls / BotG flag
      next: Check harp storyflag
  - name: Check harp storyflag
    type: checkstoryflag
    flow:
      checkstoryflag: 9
    cases:
      - Set GoT raised
      - -1
  - name: Set GoT raised
    type: setstoryflag
    flow:
      setstoryflag: 340
      next: Set imp2 defeated
  - name: Set imp2 defeated
    onlyif: skip_harp_playing == on
    type: setstoryflag
    flow:
      setstoryflag: 132
      next: Set Thunderhead Open storyflag
  - name: Set imp2 defeated
    onlyif: skip_harp_playing == off
    type: setstoryflag
    flow:
      setstoryflag: 132
      next: -1
  - name: Set Thunderhead Open storyflag
    type: setstoryflag
    flow:
      setstoryflag: 194 # Thunderhead is open
      next: Set Skyloft Thunderhead sceneflag
  - name: Set Skyloft Thunderhead sceneflag
    type: flowadd
    flow:
      type: type3
      next: -1
      param3: 73 # Custom command
  - name: Don't change to Skyloft layer 8/9 after getting the Triforce
    type: flowpatch
    index: 540 # before storyflag
    flow:
      next: -1 # after Storyflag
  - name: Go to Harp Storyflag
    type: flowpatch
    index: 71
    flow:
      next: Goddess's Harp Storyflag
  - name: Goddess's Harp Storyflag
    type: setstoryflag
    flow:
      setstoryflag: 9
      next: Groose lands in Faron Storyflag
  - name: Groose lands in Faron Storyflag
    type: setstoryflag
    flow:
      setstoryflag: 140
      next: Check BotG storyflag
  - name: Check BotG storyflag
    type: checkstoryflag
    flow:
      checkstoryflag: 493 # Unlocked Goddess Walls / BotG flag
    cases:
      - Set GoT raised
      - -1
  - name: Go to Letter Storyflag
    type: flowpatch
    index: 377
    flow:
      next: Letter Storyflag
  - name: Letter Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 547
      next: -1
      param3: 0
  - name: Go to Beedle's Insect Cage Storyflag
    type: flowpatch
    index: 380
    flow:
      next: Beedle's Insect Cage Storyflag
  - name: Beedle's Insect Cage Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 476
      next: -1
      param3: 0
  - name: To Set Adventure Pouch Storyflag
    type: flowpatch
    index: 603
    flow:
      next: Set Adventure Pouch Storyflag
  - name: Set Adventure Pouch Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 30 # adventure pouch unlocked
      next: -1
      param3: 0
  - name: To Set Adventure Pouch counter
    type: flowpatch
    index: 604
    flow:
      next: Add pouch slot
  - name: Add pouch slot
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 490 # counterindex
      param2: 1 # count
      next: -1
      param3: 25 # add to counter command
  - name: To Set Faron Pillar Storyflag
    type: flowpatch
    index: 385
    flow:
      next: Set Faron Pillar Storyflag
  - name: Set Faron Pillar Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 46 # Faron Pillar
      next: -1
      param3: 0
  - name: To Set Eldin Pillar Storyflag
    type: flowpatch
    index: 384
    flow:
      next: Set Eldin Pillar Storyflag
  - name: Set Eldin Pillar Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 47 # Eldin Pillar
      next: -1
      param3: 0
  - name: To Set Lanayru Pillar Storyflag
    type: flowpatch
    index: 389
    flow:
      next: Set Lanayru Pillar Storyflag
  - name: Set Lanayru Pillar Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 48 # Lanayru Pillar
      next: -1
      param3: 0
  - name: Always show 5 Deku Seeds text
    type: flowpatch
    index: 92
    flow:
      next: 16
  - name: Always show single Arrow text
    type: flowpatch
    index: 139
    flow:
      next: 80
  - name: Always same Bomb text
    type: flowpatch
    index: 180
    flow:
      next: 161
  - name: To Fill Bombs
    type: flowpatch
    index: 161
    flow:
      next: Fill Bombs
  - name: Fill Bombs
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 499 # counterindex
      param2: 10 # count
      next: 414
      param3: 25 # add to counter command
  - name: Sea Chart unlocks Ship Dowsing
    type: flowpatch
    index: 528
    flow:
      next: Sea Chart dowsing
  - name: Sea Chart dowsing
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 271 # Ship Dowsing
      next: Open Dowsing wheel
      param3: 0
  - name: Open Dowsing wheel
    type: flowadd
    flow:
      type: type3
      subType: 6
      param1: 0
      param2: 7
      next: -1
      param3: 56
  - name: Remove open map demo after dungeon map
    type: flowpatch
    index: 613
    flow:
      next: -1
  - name: Remove bipping after getting slingshot
    type: flowpatch
    index: 520
    flow:
      next: -1
  - name: Prevent Sacred Water setting flags 1
    type: flowpatch
    index: 155
    flow:
      next: 156
  - name: Prevent Sacred Water setting flags 2
    type: flowpatch
    index: 156
    flow:
      next: -1
  # - name: Set GoT flags on MS
  #   type: flowpatch
  #   index: 74
  #   flow:
  #     next: Set AC flag for GoT on required sword
  # - name: Set AC flag for GoT on required sword
  #   type: setstoryflag
  #   flow:
  #     setstoryflag: 11
  #     next: Set FS flag for GoT on required sword
  # - name: Set FS flag for GoT on required sword
  #   type: setstoryflag
  #   flow:
  #     setstoryflag: 13
  #     next: -1

  # Full wallet upgrades
  - name: Patch Medium Wallet
    onlyif: full_wallet_upgrades == on
    type: flowpatch
    index: 246
    flow:
      next: Fill Medium Wallet
  - name: Fill Medium Wallet
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 0
      param2: 200 # Rupees to add
      next: -1
      param3: 8 # Increase rupee count
  - name: Patch Big Wallet
    onlyif: full_wallet_upgrades == on
    type: flowpatch
    index: 245
    flow:
      next: Fill Big Wallet
  - name: Fill Big Wallet
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 0
      param2: 500 # Rupees to add
      next: -1
      param3: 8 # Increase rupee count
  - name: Patch Giant Wallet
    onlyif: full_wallet_upgrades == on
    type: flowpatch
    index: 244
    flow:
      next: Fill Giant Wallet
  - name: Fill Giant Wallet
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 0
      param2: 4000 # Rupees to add
      next: -1
      param3: 8 # Increase rupee count
  - name: Patch Tycoon Wallet
    onlyif: full_wallet_upgrades == on
    type: flowpatch
    index: 255
    flow:
      next: Fill Tycoon Wallet
  - name: Fill Tycoon Wallet
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 0
      param2: 4000 # Rupees to add
      next: -1
      param3: 8 # Increase rupee count
  - name: Patch Extra Wallets
    onlyif: full_wallet_upgrades == on
    type: flowpatch
    index: 497
    flow:
      next: Fill Extra Wallets
  - name: Fill Extra Wallets
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 0
      param2: 300 # Rupees to add
      next: -1
      param3: 8 # Increase rupee count

004-Object:
  - name: Remove Heart piece hint from gossip stone
    type: flowpatch
    index: 76
    flow:
      next: -1
  - name: Force text for lower platform cave hint
    type: flowpatch
    index: 57
    flow:
      next: 56
  - name: Force text for upper platform cave hint
    type: flowpatch
    index: 31
    flow:
      next: 30

005-Tutorial:
  - name: Help Text Title 1a
    type: textpatch
    index: 138
  - name: Help Text Title 1b
    type: textpatch
    index: 139
  - name: Help Text Title 1c
    type: textpatch
    index: 140
  - name: Help Text Content 1a
    type: textpatch
    index: 141
  - name: Help Text Content 1b
    type: textpatch
    index: 142
  - name: Help Text Content 1b
    type: textpatch
    index: 143
  - name: Help Text Content 1c
    type: textpatch
    index: 144
  - name: Help Text Content 1c
    type: textpatch
    index: 145
  - name: Help Text Content 1c
    type: textpatch
    index: 146

  - name: Help Text Title 2a
    type: textpatch
    index: 148
  - name: Help Text Title 2b
    type: textpatch
    index: 149
  - name: Help Text Title 2c
    type: textpatch
    index: 150
  - name: Help Text Content 2a
    type: textpatch
    index: 151
  - name: Help Text Content 2b
    type: textpatch
    index: 152
  - name: Help Text Content 2c
    type: textpatch
    index: 153
  
  - name: Help Text Title 3a
    type: textpatch
    index: 155
  - name: Help Text Title 3b
    type: textpatch
    index: 156
  - name: Help Text Title 3c
    type: textpatch
    index: 157
  - name: Help Text Content 3a
    type: textpatch
    index: 158
  - name: Help Text Content 3a
    type: textpatch
    index: 161
  - name: Help Text Content 3b
    type: textpatch
    index: 159
  - name: Help Text Content 3b
    type: textpatch
    index: 162
  - name: Help Text Content 3c
    type: textpatch
    index: 160
  - name: Help Text Content 3c
    type: textpatch
    index: 163

006-8KenseiNormal:
  - name: Entry for forced Required Dungeons Text
    type: entryadd
    entry:
      name: "006_899"
      value: Forced Required Dungeons Start
  - name: Forced Required Dungeons Start
    type: flowadd
    flow:
      type: start
      next: Display Forced Required Dungeons Text
  - name: Forced Required Dungeons Text
    type: textadd
    textboxtype: 2 # Fi text box background
  - name: Display Forced Required Dungeons Text
    type: flowadd
    flow:
      type: type1
      next: Give Forced Required Dungeon Text Storyflag
      param3: 68
      param4: Forced Required Dungeons Text
  - name: Give Forced Required Dungeon Text Storyflag
    type: setstoryflag
    flow:
      setstoryflag: 954
      next: Display Forced Objective Text
  - name: Display Forced Objective Text
    type: flowadd
    flow:
      type: type1
      next: Display Required Dungeons
      param3: 68
      param4: Fi Objective Text

  - name: Allow Amiibo Warp without actual Amiibo
    type: flowpatch
    index: 28
    flow: {}
    cases:
      - 21 # Vanilla
      - 25 # Vanilla
      - 13 # Skip amiibo

  # Main Fi menu
  - name: Show custom Fi text
    type: flowpatch
    index: 2
    flow:
      next: Display Fi Call Text
  - name: Display Fi Call Text
    type: flowadd
    flow:
      type: type1
      next: Fi Option Switch
      param3: 68
      param4: 6 # text index 6
  - name: Fi Option Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 6 # Information
      - 5 # Play Time / Analysis
      - Display Fi Objective Text
      - 5
      - -1
  - name: Patch Fi Call Information Option
    type: textpatch
    index: 16
  - name: Patch Fi Call Use amiibo Option
    type: textpatch
    index: 17

  # Fi Information
  - name: Fi Information Text Patch
    type: textpatch
    index: 15
  - name: Fi Information Menu
    type: flowpatch
    index: 7
    flow: {}
    cases:
      - Display Fi Hints Text 0 # Hints
      - Check Fi Note 0 Found # Notes (other hints already found)
      - Display Required Dungeons
      - -1 # Never Mind

  # Fi Objective
  - name: Display Fi Objective Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 68
      param4: Fi Objective Text

  # Fi Warp
  - name: Fi Warp Text
    type: textadd
    textboxtype: 2 # Fi text box background
  - name: Add Fi Warp choice
    type: flowpatch
    index: 9
    flow:
      next: Display Fi Warp choice
  - name: Display Fi Warp choice
    type: flowadd
    flow:
      type: type1
      next: Fi Warp Switch
      param3: 68
      param4: Fi Warp Text
  - name: Fi Warp Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - Warp to Start
      - 28
      - -1
  - name: Warp to Start
    type: flowadd
    flow:
      type: type3
      next: -1
      param3: 70 # Custom command

100-Town:
  - name: Remove Attention Mark from Pipit at night
    type: flowpatch
    index: 168
    flow: {}
    cases:
      - 167
      - 165

  - name: Patch Barrel Delivery Text
    type: flowpatch
    index: 144
    flow:
      next: Show Attention Mark Switch
  - name: Show Attention Mark Switch
    type: switchadd
    flow:
      subType: 6
      param2: 23 # Sceneflag 23 - has received barrel check
      param3: 6
    cases:
      - 145 # yes - don't show
      - Show Attention Mark before Delivering Barrel # no - show mark
  - name: Show Attention Mark before Delivering Barrel
    type: attentionmark
    flow:
      next: Delivered Barrel Switch
  - name: Delivered Barrel Switch
    type: switchadd
    flow:
      subType: 6
      param2: 22 # Sceneflag 22 - has delivered barrel
      param3: 6
    cases:
      - Have Received Barrel Delivery Check # yes - check if already given check
      - 145 # no - behave like vanilla
  - name: Have Received Barrel Delivery Check
    type: switchadd
    flow:
      subType: 6
      param2: 23 # Sceneflag 23 - received barrel check
      param3: 6
    cases:
      - 145 # yes - ignore
      - 147 # no - give randomized item
  - name: Patch Barrel Delivered Text
    type: flowpatch
    index: 147
    flow:
      next: Give Barrel Devlivery Item
  - name: Give Barrel Devlivery Item
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 4 # item
      next: Set Received Barrel Check Sceneflag
      param3: 9
  - name: Set Received Barrel Check Sceneflag
    type: setsceneflag
    flow:
      sceneindex: 0 # Skyloft
      setsceneflag: 23
      next: -1

101-Shop:
  - name: Remove pouch bipping after item seller
    type: flowpatch
    index: 89
    flow:
      next: 116

102-Zelda:
  - name: Fledge Quest Switch 1
    type: flowpatch
    index: 230
    flow:
      param2: 36 # always trigger
  - name: Fledge Quest Switch 2
    type: flowpatch
    index: 229
    flow:
      param2: 36 # always trigger

105-Terry:
  - name: Beedle's Crystal # Can't reach that right now
    type: flowpatch
    index: 115
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Can't buy Pouch text
    type: textadd
  - name: Show can't buy Pouch text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 87
      param4: Can't buy Pouch text
  - name: Check for Pouch
    type: switchadd
    flow:
      subType: 6
      param2: 30 # Adventure pouch unlocked
      param3: 3
    cases:
      - 43 # do event as normal
      - Show can't buy Pouch text
  - name: go to Check for Pouch
    onlyif: beedle_shop_shuffle == vanilla
    type: flowpatch
    index: 16
    flow:
      next: Check for Pouch
  # - name: Beedle Half Off Bug Net Text
  #   type: textpatch
  #   index: 26

  - name: Second 100 Rupee Item
    onlyif: beedle_shop_shuffle != vanilla
    type: entryadd
    entry:
      name: "105_39"
      value: Second 100R first event
  - name: Second 100R first event
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type3
      subType: 6
      param1: 0
      param2: 1
      next: Second 100R second event
      param3: 12
  - name: Second 100R second event
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type3
      subType: 4
      param1: 0
      param2: 21
      next: Second 100R discount switch 1
      param3: 13
  - name: Second 100R discount switch 1
    onlyif: beedle_shop_shuffle != vanilla
    type: switchadd
    flow:
      subType: 6
      param2: 478 # Already used discount
      param3: 3
    cases:
      - Show Second 100R undiscounted Text
      - Second 100R discount switch 2
  - name: Second 100R discount switch 2
    onlyif: beedle_shop_shuffle != vanilla
    type: switchadd
    flow:
      subType: 6
      param2: 477 # Gave Beedles Beetle, has discount
      param3: 3
    cases:
      - Show Second 100R discounted Text
      - Show Second 100R undiscounted Text
  - name: Show Second 100R undiscounted Text
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type1
      next: 13 # buying switch
      param3: 87
      param4: Second 100R undiscounted Text
  - name: Show Second 100R discounted Text
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type1
      next: 13 # buying switch
      param3: 87
      param4: Second 100R discounted Text

  - name: Third 100 Rupee Item
    onlyif: beedle_shop_shuffle != vanilla
    type: entryadd
    entry:
      name: "105_40"
      value: Third 100R first event
  - name: Third 100R first event
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type3
      subType: 6
      param1: 0
      param2: 1
      next: Third 100R second event
      param3: 12
  - name: Third 100R second event
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type3
      subType: 4
      param1: 0
      param2: 21
      next: Third 100R discount switch 1
      param3: 13
  - name: Third 100R discount switch 1
    onlyif: beedle_shop_shuffle != vanilla
    type: switchadd
    flow:
      subType: 6
      param2: 478 # Already used discount
      param3: 3
    cases:
      - Show Third 100R undiscounted Text
      - Third 100R discount switch 2
  - name: Third 100R discount switch 2
    onlyif: beedle_shop_shuffle != vanilla
    type: switchadd
    flow:
      subType: 6
      param2: 477 # Gave Beedles Beetle, has discount
      param3: 3
    cases:
      - Show Third 100R discounted Text
      - Show Third 100R undiscounted Text
  - name: Show Third 100R undiscounted Text
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type1
      next: 13 # buying switch
      param3: 87
      param4: Third 100R undiscounted Text
  - name: Show Third 100R discounted Text
    onlyif: beedle_shop_shuffle != vanilla
    type: flowadd
    flow:
      type: type1
      next: 13 # buying switch
      param3: 87
      param4: Third 100R discounted Text

106-DrugStore:
  - name: Potion Lady Text Patch # generalized for rando
    type: textpatch
    index: 5
  - name: Potion Lady Bottle # skip pouch requirements
    type: flowpatch
    index: 42
    flow:
      next: 44 # give item
  - name: Requirement for Stamina Potion
    type: flowpatch
    index: 103
    flow:
      param2: 8 # raised LMF
  - name: Remove pouch bipping from Potion Lady
    type: flowpatch
    index: 115
    flow:
      next: 111

107-Kanban:
  - name: Fi give Goddess Statue items
    type: flowpatch
    index: 12
    flow:
      next: Fi give Goddess Statue item 1
  - name: Fi give Goddess Statue item 1
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Fi give Goddess Statue item 2
      param3: 9
  - name: Fi give Goddess Statue item 2
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: -1
      param3: 9
  - name: Fi give Boko Base Sword item start
    type: flowpatch
    index: 15
    flow:
      next: Fi give Boko Base Sword item
  - name: Fi give Boko Base Sword item
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Set Boko Base Sword item Storyflag
      param3: 9
  - name: Set Boko Base Sword item Storyflag
    type: setstoryflag
    flow:
      setstoryflag: 952
      next: -1
  - name: Add flow for Sky Keep goal location sign
    type: entryadd
    entry:
      name: "107_99"
      value: Sky Keep goal location sign start
  - name: Sky Keep goal location sign start
    type: flowadd
    flow:
      type: start
      next: Show Sky Keep goal location sign text 
  - name: Sky Keep goal location sign text with replaced text
    type: textadd
  - name: Show Sky Keep goal location sign text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 88
      param4: Sky Keep goal location sign text with replaced text

108-ShinkanA:
  - name: Owlans Shield
    type: flowpatch
    index: 168
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      next: 172 # end of owlans text
      param3: 9
      param4: 0
      param5: 0
  - name: Remove bipping after Owlan's Gift
    type: flowpatch
    index: 165
    flow:
      next: -1
  - name: Hint to owlan crystals
    type: flowpatch
    index: 271
    flow:
      param2: 57 # changes switch condition to kikwi elder slingshot storyflag
  - name: Does not have slingshot
    type: textpatch
    index: 68 # switch is false
  - name: Does have slingshot
    type: textpatch
    index: 69 # switch is true
  - name: Horwell Mia start
    type: flowpatch
    index: 9
    flow: {}
    cases:
      - Can talk to Horwell
      - Can talk to Horwell
  - name: Can talk to Horwell
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 3
      param2: -1
      next: 48 # Check if Mia has been saved
      param3: 42
  - name: Mia saved switch
    type: flowpatch
    index: 48
    flow: {}
    cases:
      - 51 # Check if already given item
      - Show Attention Mark before saving Mia
  - name: Show Attention Mark before saving Mia
    type: attentionmark
    flow:
      next: 7 # Horwell asks if you'll save Mia
  - name: Remove camera panning after saving Mia
    type: flowpatch
    index: 49
    flow:
      next: 242
  - name: Horwell item
    type: flowpatch
    index: 292
    flow:
      type: type3
      subType: 0
      param2: 0 # item
      next: -1
      param3: 9

109-TakeGoron:
  - name: Peater's Crystal 1
    type: flowpatch
    index: 79
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Peater's Crystal 2
    type: flowpatch
    index: 92
    flow:
      next: 79
  - name: To Sword Check
    # prevent playing bamboo cutting without any sword
    type: flowpatch
    index: 35
    flow: {}
    cases:
      - Sword Check # soup has been delivered, normal event
      - 37 # no
  - name: Sword Check
    type: switchadd
    flow:
      subType: 6
      param2: 906 # Rando storyflag for practice sword
      param3: 3
    cases:
      - 36 # normal text
      - Show No Sword Text
  - name: No Sword Text
    type: textadd
  - name: Show No Sword Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 109
      param4: No Sword Text

  - name: Patch Clean Cut Pre-reward Switch
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 7
    flow: {}
    cases:
      - 10
      - 10
      - 10
      - 10
  - name: Clean Cut Guaranteed Win Reward Choice Text
    type: textadd
  - name: Clean Cut Guaranteed Win Reward Choice Start
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 10
    flow:
      next: Show Clean Cut Guaranteed Win Reward Choice Text
  - name: Show Clean Cut Guaranteed Win Reward Choice Text
    type: flowadd
    flow:
      type: type1
      next: Show Clean Cut Guaranteed Win Reward Choice Switch
      param3: 3
      param4: Clean Cut Guaranteed Win Reward Choice Text
  - name: Show Clean Cut Guaranteed Win Reward Choice Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 15 # Rare Treasure
      - 14 # Uncommon Treasure
      - 13 # 30 Rupees
  - name: Remove Text after Clean Cut Rupee Reward
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 13
    flow:
      next: 27
  - name: Remove Text after Clean Cut Uncommon Treasure Reward
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 14
    flow:
      next: 27

  - name: Clean Cut Easy No Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 23
  - name: Clean Cut Easy Low Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 25
  - name: Clean Cut Easy Mid Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 27
  
  - name: Clean Cut Hard No Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 23
  - name: Clean Cut Hard Low Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 25
  - name: Clean Cut Hard Mid Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 27

110-DivingGame:
  - name: Require Scrapper before starting quest
    type: flowpatch
    index: 44
    flow:
      param2: 323 # Replace check for windmill repaired with scrapper obtained
  - name: Fun Fun Owner's Quest requirement
    type: flowpatch
    index: 38
    flow:
      param2: 36 # always trigger
  - name: Fun Fun Owner's Crystal
    type: flowpatch
    index: 60
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0

111-FortuneTeller:
  - name: Skip over Water Basin dowsing
    type: flowpatch
    index: 99
    flow:
      param2: 668
  - name: Skip over Wheel opening
    type: flowpatch
    index: 104
    flow:
      param2: 96

113-RemodelStore:
  - name: remove Treasure Dowsing 1
    type: flowpatch
    index: 123
    flow:
      next: -1
  - name: remove Treasure Dowsing 2
    type: flowpatch
    index: 13
    flow:
      next: -1
  - name: Gondo patch
    type: flowpatch
    index: 92
    flow:
      param2: 322 # Learn about Scrapper near Village Windmill (repurposed for rando)
    cases:
      - 93 # true
      - Show Gondo Options # false
  - name: Patch Gondo Options Text After Check
    type: textpatch
    index: 114
  - name: Gondo Options Text
    type: textadd
  - name: Show Gondo Options
    type: flowadd
    flow:
      type: type1
      next: Gondo Options Switch
      param3: 103
      param4: Gondo Options Text
  - name: Gondo Options Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 31 # Upgrade gear.
      - 69 # Fix shield.
      - 97 # Repair Junk?
      - 3 # Never mind.
  - name: Patch Gondo Repair Scrapper Text 1
    type: textpatch
    index: 101
  - name: Patch Gondo Repair Scrapper Text 2
    type: textpatch
    index: 108
  - name: Skip Scrapper Repaired Text 1
    type: flowpatch
    index: 59
    flow:
      next: 118
  - name: Skip Scrapper Repaired Text 2
    type: flowpatch
    index: 118
    flow:
      next: 134
  - name: Patch post Gondo Repair Text
    type: textpatch
    index: 115
  - name: Skip Scrapper Repaired Text 3
    type: flowpatch
    index: 134
    flow:
      next: 50 # give scrapper repaired flag
  - name: Skip Scrapper Repaired Text 4
    type: flowpatch
    index: 50
    flow:
      param2: 322 # Learn about Scrapper near Village Windmill (repurposed for rando)
      next: Give Repair Gondo Junk item
  - name: Give Repair Gondo Junk item
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: -1
      param3: 9

114-Friend:
  - name: Patch Fledge's Gift
    type: flowpatch
    index: 14
    flow:
      next: Check if given item
  - name: Check if given item
    type: checkstoryflag
    flow:
      checkstoryflag: 923 # Gotten Fledge's Gift
    cases:
      - 48 # Continue as normal
      - Show Attention Mark
  - name: Show Attention Mark
    type: attentionmark
    flow:
      next: Set Fledge's Gift flag
  - name: Set Fledge's Gift flag
    type: setstoryflag
    flow:
      setstoryflag: 923 # Gotten Fledge's Gift
      next: 15
  - name: Skip Fledge camera panning 1
    type: flowpatch
    index: 15
    flow:
      next: 22
  - name: Skip Fledge talking about the hero's tunic
    type: flowpatch
    index: 22
    flow:
      next: 51
  - name: Skip Fledge wait frames
    type: flowpatch
    index: 51
    flow:
      next: 50
  - name: Skip more Fledge camera panning
    type: flowpatch
    index: 50
    flow:
      next: 16
  - name: Skip Fledge talking about the Adventure Pouch # skips part explaining the adventure pouch
    type: flowpatch
    index: 16
    flow:
      next: -1

  - name: Pumpkin Archery Guaranteed Win Reward Choice Text
    type: textadd
  - name: Pumpkin Archery Guaranteed Win Reward Choice Start
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 105
    flow:
      next: Show Pumpkin Archery Guaranteed Win Reward Choice Text
  - name: Show Pumpkin Archery Guaranteed Win Reward Choice Text
    type: flowadd
    flow:
      type: type1
      next: Show Pumpkin Archery Guaranteed Win Reward Choice Switch
      param3: 3
      param4: Pumpkin Archery Guaranteed Win Reward Choice Text
  - name: Show Pumpkin Archery Guaranteed Win Reward Choice Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 89 # Rare Treasure
      - 88 # Uncommon Treasure
      - 87 # 50 Rupees
  - name: Remove Text after Pumpkin Archery Uncommon Treasure Reward
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 88
    flow:
      next: 91

  - name: Pumpkin Archery Easy No Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 35
  - name: Pumpkin Archery Easy Low Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 36
  - name: Pumpkin Archery Easy Mid Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 38

  - name: Pumpkin Archery Hard No Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 35
  - name: Pumpkin Archery Hard Low Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 36
  - name: Pumpkin Archery Hard Mid Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 38

115-Town2:
  - name: Parrow's Empty Bottle
    type: flowpatch
    index: 734
    flow:
      next: 735 # jump to give item
  - name: Parrow's Spores Bottle
    type: flowpatch
    index: 199
    flow:
      next: 746 # to item
  - name: Parrow's Crystal 1
    type: flowpatch
    index: 813
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Parrow's Crystal 2
    type: flowpatch
    index: 787
    flow:
      next: 813
  - name: Feldge's Crystal
    type: flowpatch
    index: 325
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Baby's Crystal
    type: flowpatch
    index: 125
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Orrielle's Crystal
    type: flowpatch
    index: 225
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Ghost's Crystal
    type: flowpatch
    index: 522
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Pipit's Crystal
    type: flowpatch
    index: 641
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Skip Clawshots Requirement for Rattle Delivery
    type: flowpatch
    index: 7
    flow:
      next: 8
  - name: Change Cawlin storyflag
    type: flowpatch
    index: 165
    flow:
      param2: 924
  - name: Fix Cawlin switch to use rando storyflag
    type: flowpatch
    index: 33
    flow:
      param2: 924
  - name: Remove Attention Mark after Cawlin gives item
    type: flowpatch
    index: 58
    flow: {}
    cases:
      - 61
      - 113
  - name: Fix Cawlin switch to always give item
    type: flowpatch
    index: 141
    flow: {}
    cases:
      - Add Attention Mark before Cawlin gives item
      - Add Attention Mark before Cawlin gives item
  - name: Add Attention Mark before Cawlin gives item
    type: attentionmark
    flow:
      next: 163
  - name: Add Cawlin storyflag to other text options
    type: flowpatch
    index: 507
    flow:
      next: 503
  - name: Skip to end of fledge 2
    type: flowpatch
    index: 347 # after giving fledge the second stamina potion
    flow:
      next: 353
  - name: Skip Fledge 3
    type: flowpatch
    index: 353
    flow:
      next: 320 # before crystal itemget

  - name: Change Night Treasures/Bugs Question
    type: textadd

  # Cycle through Rupin's night market options
  - name: Patch in new treasure choices question
    type: flowpatch
    index: 410
    flow:
      next: Show Change Night Treasures Question
  - name: Show Change Night Treasures Question
    type: flowadd
    flow:
      type: type1
      next: Treasure Question Switch
      param3: 115
      param4: Change Night Treasures/Bugs Question
  - name: Treasure Question Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 495 # Ask to buy again (asm patched to chance choices)
      - -1

  # Cycle through Strich's night market options
  - name: Patch in new bug choices question
    type: flowpatch
    index: 473
    flow:
      next: Show Change Night Bugs Question
  - name: Show Change Night Bugs Question
    type: flowadd
    flow:
      type: type1
      next: Bug Question Switch
      param3: 115
      param4: Change Night Treasures/Bugs Question
  - name: Bug Question Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 476 # Ask to buy again (asm patched to chance choices)
      - -1

116-InsectGame:
  - name: Fix switch 1
    type: flowpatch
    index: 25
    flow:
      param2: 925
  - name: Fix switch 2
    type: flowpatch
    index: 61
    flow:
      param2: 925
  - name: Fix switch 3
    type: flowpatch
    index: 24
    flow:
      param2: 36 # always trigger
  - name: getting item from Strich flag
    type: flowpatch
    index: 68
    flow:
      param2: 925
  
  - name: Bug Heaven Guaranteed Win Reward Choice Text
    type: textadd
  - name: Bug Heaven Guaranteed Win Reward Choice Start
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 84
    flow:
      next: Show Bug Heaven Guaranteed Win Reward Choice Text
  - name: Show Bug Heaven Guaranteed Win Reward Choice Text
    type: flowadd
    flow:
      type: type1
      next: Show Bug Heaven Guaranteed Win Reward Choice Switch
      param3: 3
      param4: Bug Heaven Guaranteed Win Reward Choice Text
  - name: Show Bug Heaven Guaranteed Win Reward Choice Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 85 # Rare Bugs
      - 82 # Uncommon Bugs
      - 81 # 80 Rupees

  - name: Bug Heaven Easy No Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 15
  - name: Bug Heaven Easy Beginner Low Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 24
  - name: Bug Heaven Easy Wrangler Low Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 16
  - name: Bug Heaven Easy Beginner Mid Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 26
  - name: Bug Heaven Easy Wrangler Mid Prize Text
    onlyif: minigame_difficulty == easy
    type: textpatch
    index: 18

  - name: Bug Heaven Hard No Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 15
  - name: Bug Heaven Hard Beginner Low Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 24
  - name: Bug Heaven Hard Wrangler Low Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 16
  - name: Bug Heaven Hard Beginner Mid Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 26
  - name: Bug Heaven Hard Wrangler Mid Prize Text
    onlyif: minigame_difficulty == hard
    type: textpatch
    index: 18

117-Pumpkin:
  - name: Check if Pumm should give Kina Quest Storyflag
    type: flowpatch
    index: 52
    flow:
      next: Check for Scrapper Storyflag
  - name: Check for Scrapper Storyflag
    type: switchadd
    flow:
      subType: 6
      param2: 323 # Scrapper Storyflag
      param3: 3
    cases:
      - Give Kina Quest Storyflag
      - -1
  - name: Give Kina Quest Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 470 # Kina Storyflag
      next: -1
      param3: 0
  - name: Kina's Crystal
    type: flowpatch
    index: 386
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: playing Harp with Kina 1
    type: flowpatch
    index: 434
    flow:
      param2: 9 # Harp
  - name: playing Harp with Kina 2
    type: flowpatch
    index: 80
    flow:
      param2: 9 # Harp
  - name: playing Harp with Kina 3
    type: flowpatch
    index: 579
    flow:
      param2: 9 # Harp
  - name: Fs requirement for Kina Quest
    type: flowpatch
    index: 93
    flow:
      param2: 36 # always trigger
  - name: ET requirement for Pumpkin Quest
    type: flowpatch
    index: 78
    flow:
      param2: 36 # always trigger
  - name: Switch for Chandelier just fell
    type: switchadd
    flow:
      subType: 6
      param2: 3
      param3: 5 # zone temp flag 3, set after crashing chandelier
    cases:
      - 520 # jump over soup
      - 118 # normal event
  - name: Show Levias or other text before going down Quest
    # this switch checks if the soup has been delivered to levias
    # if no, it would normally only allow levias stuff, which locks the normal lumpy pumpkin quest
    type: flowpatch
    index: 211
    flow: {}
    cases:
      - 216 # soup has been delivered, normal event
      - Check for Scrapper
  - name: Check for Scrapper
    type: switchadd
    flow:
      subType: 6
      param2: 323 # Scrapper repaired
      param3: 3 # check storyflag
    cases:
      - Show new Text Option # soup has not been delivered, ask which quest to do
      - 216 # no scrapper = normal event
  - name: Go to Switch for Chandelier
    type: flowpatch
    index: 6
    flow:
      next: Switch for Chandelier just fell
  - name: Fix Soup textboxes
    type: textpatch
    index: 143
  - name: Go back to Chandelier Quest
    type: flowpatch
    index: 347
    flow:
      next: 520
  - name: New text Option
    type: textadd
  - name: Show new Text Option
    type: flowadd
    flow:
      type: type1
      next: Text option Switch
      param3: 111
      param4: New text Option
  - name: Text option Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 208
      - 216
  - name: New Kina Text Option
    type: textadd
  - name: Kina Quest Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - Kina Scrapper Check
      - 200 # pumpkin carrying
      - -1 # nothing
  - name: Kina Scrapper Check
    type: switchadd
    flow:
      subType: 6
      param2: 323 # Scrapper check
      param3: 3 # check storyflag
    cases:
      - 96 # continue to mogma quest prompt if true
      - Kina Scrapper Hint # else lament about transport
  - name: Kina Scrapper Hint
    type: flowadd
    flow:
      type: type1
      next: -1
      param4: Kina Scrapper Hint Text
  - name: Kina Scrapper Hint Text
    type: textadd
  - name: Show Kina Option
    type: flowpatch
    index: 605
    flow:
      type: type1
      next: Kina Quest Switch
      param4: New Kina Text Option
  - name: Shorten Kina Text
    type: flowpatch
    index: 97
    flow:
      next: 103
  # Fix pumpkin soup from Pumm
  - name: Goto set fill bottle storyflag for giving soup 1
    type: flowpatch
    index: 535
    flow:
      next: Set fill bottle storyflag for soup 1
  - name: Set fill bottle storyflag for soup 1
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      next: 322
  - name: Goto unset fill bottle storyflag for giving soup 1
    type: flowpatch
    index: 322
    flow:
      next: Unset fill bottle storyflag for soup 1
  - name: Unset fill bottle storyflag for soup 1
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      param3: 1 # actually unset the flag
      next: 550

  - name: Goto set fill bottle storyflag for giving soup 2
    type: flowpatch
    index: 530
    flow:
      next: Set fill bottle storyflag for soup 2
  - name: Set fill bottle storyflag for soup 2
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      next: 117
  - name: Goto unset fill bottle storyflag for giving soup 2
    type: flowpatch
    index: 117
    flow:
      next: Unset fill bottle storyflag for soup 2
  - name: Unset fill bottle storyflag for soup 2
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      param3: 1 # actually unset the flag
      next: 549

  - name: Goto set fill bottle storyflag for giving soup 3
    type: flowpatch
    index: 532
    flow:
      next: Set fill bottle storyflag for soup 3
  - name: Set fill bottle storyflag for soup 3
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      next: 29
  - name: Goto unset fill bottle storyflag for giving soup 3
    type: flowpatch
    index: 29
    flow:
      next: Unset fill bottle storyflag for soup 3
  - name: Unset fill bottle storyflag for soup 3
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      param3: 1 # actually unset the flag
      next: 156
  
  - name: Goto set fill bottle storyflag for giving soup 4
    type: flowpatch
    index: 533
    flow:
      next: Set fill bottle storyflag for soup 4
  - name: Set fill bottle storyflag for soup 4
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      next: 30
  - name: Goto unset fill bottle storyflag for giving soup 4
    type: flowpatch
    index: 30
    flow:
      next: Unset fill bottle storyflag for soup 4
  - name: Unset fill bottle storyflag for soup 4
    type: setstoryflag
    flow:
      setstoryflag: 894 # Should fill bottle not create new
      param3: 1 # actually unset the flag
      next: 77

  # Harp Minigame patches
  - name: Harp Minigame Guaranteed Win Pumm
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 329
    flow: {}
    cases:
      - 332
      - 257
  - name: Harp Minigame Easy Pumm 1
    onlyif: minigame_difficulty == easy
    type: flowpatch
    index: 330
    flow: {}
    cases:
      - 600
      - 333
      - 332
      - 332
  - name: Harp Minigame Easy Pumm 2
    onlyif: minigame_difficulty == easy
    type: flowpatch
    index: 255
    flow: {}
    cases:
      - 601
      - 256
      - 257
      - 257
  - name: Harp Minigame Hard Pumm 1
    onlyif: minigame_difficulty == hard
    type: flowpatch
    index: 330
    flow: {}
    cases:
      - 331
      - 331
      - 600
      - 333
  - name: Harp Minigame Hard Pumm 2
    onlyif: minigame_difficulty == hard
    type: flowpatch
    index: 255
    flow: {}
    cases:
      - 254
      - 254
      - 601
      - 256
  - name: Harp Minigame Guaranteed Win Kina
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 248
    flow: {}
    cases:
      - 251
      - 251
      - 251
      - 251
  - name: Harp Minigame Easy Kina
    onlyif: minigame_difficulty == easy
    type: flowpatch
    index: 248
    flow: {}
    cases:
      - 599
      - 250
      - 251
      - 251
  - name: Harp Minigame Hard Kina
    onlyif: minigame_difficulty == hard
    type: flowpatch
    index: 248
    flow: {}
    cases:
      - 249
      - 249
      - 599
      - 250

118-Town3:
  - name: Sparrot Scrapper check
    type: flowpatch
    index: 99
    flow:
      param2: 323
    cases:
      - Normal Sparrot Storyflag Check
      - 98
  - name: Normal Sparrot Storyflag Check
    type: switchadd
    flow:
      subType: 6
      param2: 371
      param3: 3
      param4: 2
      param5: 44
    cases:
      - 425
      - 100
  - name: Remove reference to Windmill in Sparrot Quest starting text
    type: flowpatch
    index: 122
    flow:
      next: 255
  - name: Owlan Scrapper Check
    type: flowpatch
    index: 111
    flow:
      param2: 323 # Check for scrapper instead of having started batreaux quest
    cases:
      - 318
      - 110
  - name: Owlan Scrapper Hint Text
    type: textpatch
    index: 135
  - name: Remove reference to Levias in Owlan Quest starting text
    type: flowpatch
    index: 320
    flow:
      next: 116
  - name: Wryna's Crystal
    type: flowpatch
    index: 144
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Sparrot's Crystal
    type: flowpatch
    index: 141
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Owlan's Crystal
    type: flowpatch
    index: 157
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0

120-Nushi:
  - name: Fix Levias
    type: flowpatch
    index: 7
    flow:
      next: 21 # never talk about triforce or song of the hero
  - name: Remove reference to Triforce and SotH in Levias text
    type: flowpatch
    index: 0
    flow:
      next: 22
  - name: Skip bokobase story flag
    type: flowpatch
    index: 22
    flow:
      next: -1 # don't set bokobase
  - name: Give item after levias
    type: entryadd
    entry:
      name: "120_03"
      value: After levias event start
  - name: After levias event start
    type: flowadd
    flow:
      type: start
      next: give item after levias
  - name: give item after levias
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: 37 # set unset story flag
      param3: 9

121-AkumaKun:
  - name: Never say cursed medal chest text
    type: flowpatch
    index: 9 # start
    flow:
      next: 120 # normal text

123-Town5:
  - name: Peatrice's Crystal
    type: flowpatch
    index: 316
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0
  - name: Pipit's Mom's Crystal
    type: flowpatch
    index: 186
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 0 # item
      param3: 9
      param4: 0
      param5: 0

200-Forest:
  - name: Remove text and panning before Bucha gives the check
    type: flowpatch
    index: 567
    flow:
      next: 126
  - name: Remove text and panning about Slingshot after Bucha check
    type: flowpatch
    index: 140
    flow:
      next: Give Kikwi Elder Item Obtained Storyflag
  - name: Give Kikwi Elder Item Obtained Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 898 # Obtained Item from Bucha Storyflag
      next: Check for Scrapper Storyflag
      param3: 0
  - name: Check for Scrapper Storyflag
    type: switchadd
    flow:
      subType: 6
      param2: 323 # Scrapper Storyflag
      param3: 3
    cases:
      - Give Owlan Quest Storyflag
      - 369 # normal text
  - name: Give Owlan Quest Storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 479 # Started Owlan Quest Storyflag
      next: 369 # normal text
      param3: 0
  - name: Use string without reference to Slingshot when talking again after Bucha check
    type: flowpatch
    index: 119
    flow:
      param4: 106 # Change string index to use text without mention of Slingshot
  - name: Skip over Zelda Dowsing
    type: flowpatch
    index: 382
    flow:
      next: 127
  - name: Skip over Zelda Dowsing 2
    type: flowpatch
    index: 412
    flow:
      next: -1
  - name: Skip over Zelda Dowsing 3
    type: flowpatch
    index: 321
    flow:
      next: -1
  - name: Skip over Zelda Dowsing 3
    type: flowpatch
    index: 600
    flow:
      next: -1
  - name: Skip over Fi text after locating machi
    type: flowpatch
    index: 91
    flow:
      next: 313
  - name: From storyflag after machi to sceneflag
    type: flowpatch
    index: 313
    flow:
      next: 583
  - name: End after machi sceneflag
    type: flowpatch
    index: 583
    flow:
      next: -1
  - name: Skip over Fi text after locating Oolo
    type: flowpatch
    index: 32
    flow:
      next: -1
  - name: Skip over Fi text after locating Erla
    type: flowpatch
    index: 641
    flow:
      next: -1
  # HD sets the scene flag for the Fi text after this. The flag 53 (0x7 20) should now be free to use
  - name: Skip over Fi text after locating Lopsa
    type: flowpatch
    index: 163
    flow:
      next: -1
  - name: change Flag to skip over Fi telling you that you can roll
    type: flowpatch
    index: 118
    flow:
      param1: 13
      param3: 2

201-ForestD1:
  - name: give item after beating skyview
    type: flowpatch
    index: 6
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Give Skyview beaten story flag
      param3: 9
      param4: 0
      param5: 0
  - name: Give Skyview beaten story flag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 5 # Skyview beaten story flag
      next: 79 # set zone flag for exit
      param3: 0
  - name: Prevent softlock on exit
    type: flowpatch
    index: 79
    flow:
      next: -1

202-ForestD2:
  - name: Shorten Ghirahim text before Koloktos
    type: flowpatch
    index: 18
    flow:
      next: 34
  - name: Give item after AC
    type: entryadd
    entry:
      name: "202_31"
      value: After AC event start
  - name: After AC event start
    type: flowadd
    flow:
      type: start
      next: give item after beating ancient cistern
  - name: give item after beating ancient cistern
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Give Ancient Cistern beaten story flag
      param3: 9
  - name: Give Ancient Cistern beaten story flag
    type: setstoryflag
    flow:
      setstoryflag: 900 # Ancient Cistern beaten story flag
      next: Set zoneflag to trigger loadzone
  - name: Set zoneflag to trigger loadzone
    type: setzoneflag
    flow:
      setzoneflag: 3
      next: -1
  # make sure central statue can be moved down again, for that allow the player to
  # talk to the tablet and then lower the statue and reload
  - name: Statue Lower Question
    type: textpatch
    index: 4
    textboxtype: 0
  - name: Replace Stone Tablet Fi Event
    type: flowpatch
    index: 5
    flow:
      next: Statue Lower Switch
  - name: Statue Lower Switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Unset Question Trigger then lower Statue # yes
      - Unset Question Trigger # no
  - name: Unset Question Trigger
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 60 # 60 triggers fi
      param2: 12
      next: -1
      param3: 3
  - name: Unset Question Trigger then lower Statue
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 60 # 60 triggers fi
      param2: 12
      next: Unset Raise Statue Sceneflag
      param3: 3
  - name: Unset Raise Statue Sceneflag
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 126
      param2: 12
      next: Unset Lower Statue Sceneflag
      param3: 3
  - name: Unset Lower Statue Sceneflag
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 100
      param2: 12
      next: Unset Valve on Top Sceneflag
      param3: 3
  - name: Unset Valve on Top Sceneflag
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 121
      param2: 12
      next: Trigger Exit
      param3: 3
  - name: Trigger Exit
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 0
      param2: 0
      next: -1
      param3: 10

203-ForestF2:
  - name: Skip over Sacred Water dowsing
    type: flowpatch
    index: 62
    flow:
      next: 468
  - name: Offer entry into Flooded Faron
    type: flowpatch
    index: 68
    flow:
      next: Tadtones Completion Storyflag Check
  - name: Tadtones Completion Storyflag Check
    type: switchadd
    flow:
      subType: 6
      param2: 18 # All Tadtones Collected
      param3: 3
    cases:
      - Show Already Completed Tadtones Text # Tadtones complete
      - Show Flooded Faron Entry Question
  - name: Already Completed Tadtones Text
    type: textadd
  - name: Show Already Completed Tadtones Text
    type: flowadd
    flow:
      type: type1
      next: Show Flooded Faron Reentry Text
      param3: 302
      param4: Already Completed Tadtones Text
  - name: Flooded Faron Reentry Text
    type: textadd
  - name: Show Flooded Faron Reentry Text
    type: flowadd
    flow:
      type: type1
      next: Flooded Faron Reentry Switch
      param3: 302
      param4: Flooded Faron Reentry Text
  - name: Flooded Faron Reentry Switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Trigger Exit to Flooded Faron Layer 2 # Yes
      - Show Declined Flooded Faron Offer Text # No
  - name: Show Flooded Faron Entry Question
    type: flowadd
    flow:
      type: type1
      next: Flooded Faron Entry Switch
      param3: 302
      param4: Flooded Faron Entry Question
  - name: Flooded Faron Entry Question
    type: textadd
  - name: Flooded Faron Entry Switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Trigger Exit to Flooded Faron Layer 2 # Yes
      - Show Declined Flooded Faron Offer Text # No
  - name: Declined Flooded Faron Offer Text
    type: textadd
  - name: Show Declined Flooded Faron Offer Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 302
      param4: Declined Flooded Faron Offer Text
  - name: Trigger Exit to Flooded Faron Layer 2
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 5 # Entrance number
      param2: 0
      next: -1
      param3: 10 # Triggers an exit
  - name: Force Yerbal to ignore floria gates story flags
    type: flowpatch
    index: 81
    flow:
      next: Give talked to Yerbal storyflag
  - name: Give talked to Yerbal storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 63 # Talked to Yerbal storyflag
      next: 83
      param3: 0
  - name: Skip Yerbal's questions
    type: flowpatch
    index: 356
    flow:
      next: 357
  - name: Yerbal intro text
    type: textpatch
    index: 4
  - name: Go to explanation of floria gates
    onlyif: open_lake_floria != yerbal
    type: flowpatch
    index: 357
    flow:
      next: 373
  - name: Make Yerbal open the floria gates
    onlyif: open_lake_floria == yerbal
    type: flowpatch
    index: 357
    flow:
      next: Show Yerbal open floria gates text
  - name: Yerbal open floria gates text
    type: textadd
  - name: Show Yerbal open floria gates text
    type: flowadd
    flow:
      type: type1
      next: Open floria gates
      param3: 302
      param4: Yerbal open floria gates text
  - name: Open floria gates
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 49 # Floria gates opening cutscene scene flag
      param2: 2
      next: -1
      param3: 2
  - name: Yerbal floria gates intro text
    type: textpatch
    index: 24
  - name: Remove end of Yerbal's text 1
    type: flowpatch
    index: 390
    flow:
      next: -1
  - name: Remove end of Yerbal's text 2
    type: flowpatch
    index: 31
    flow:
      next: -1

204-ForestF3:
  - name: Talk to Water Dragon in Flooded Faron
    type: flowpatch
    index: 16
    flow:
      next: Check If Already Obtained Faron SotH Item
  - name: Check If Already Obtained Faron SotH Item
    type: switchadd
    flow:
      subType: 6
      param2: 16 # Received Faron SotH
      param3: 3
    cases:
      - Show Flooded Faron Exit Question # Already received item
      - 19
  - name: Exit mid tadtones
    type: flowpatch
    index: 20
    flow:
      next: Show Flooded Faron Exit Question
  - name: Show Flooded Faron Exit Question
    type: flowadd
    flow:
      type: type1
      next: Flooded Faron Exit Switch
      param3: 302
      param4: Flooded Faron Exit Question
  - name: Flooded Faron Exit Question
    type: textadd
  - name: Flooded Faron Exit Switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Trigger Exit to Non-Flooded Faron # Yes
      - Show Continue With Tadtones Text # No
  - name: Continue With Tadtones Text
    type: textadd
  - name: Show Continue With Tadtones Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 302
      param4: Continue With Tadtones Text
  - name: Trigger Exit to Non-Flooded Faron
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 5 # Entrance number
      param2: 0
      next: -1
      param3: 10 # Triggers an exit
  - name: Go to Faron SotH item
    type: flowpatch
    index: 160
    flow:
      next: Give item after Faron SotH CS
  - name: Give item after Faron SotH CS
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Trigger Exit to Non-Flooded Faron
      param3: 9
  # Gets unset in the Onp zev
  # TODO: Replace with a zev patch?
  - name: Make Bucha give the Tadtones Scroll storyflag
    type: flowpatch
    index: 195
    flow:
      param2: 82 # Tadtones Scroll storyflag
      param3: 0 # set (not unset) flag
  - name: FFW Bucha leave question text
    type: textadd
  - name: FFW Bucha leave text
    type: textadd
  - name: FFW Bucha stay text
    type: textadd
  - name: Always goto Bucha's normal text
    type: flowpatch
    index: 12
    flow:
      next: Show Attention Mark
  - name: Show Attention Mark
    type: attentionmark
    flow:
      next: 164 # Bucha's normal text
  - name: Goto Show FFW Bucha leave question text
    type: flowpatch
    index: 164
    flow:
      next: Show FFW Bucha leave question text
  - name: Show FFW Bucha leave question text
    type: flowadd
    flow:
      type: type1
      next: FFW Bucha leave switch
      param3: 140
      param4: FFW Bucha leave question text
  - name: FFW Bucha leave switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Show FFW Bucha leave text # Yes
      - Show FFW Bucha stay text # No
  - name: Show FFW Bucha stay text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 140
      param4: FFW Bucha stay text
  - name: Show FFW Bucha leave text
    type: flowadd
    flow:
      type: type1
      next: Trigger FFW Bucha exit back to Groosenator
      param3: 140
      param4: FFW Bucha leave text
  - name: Trigger FFW Bucha exit back to Groosenator
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 4 # SCEN index
      param2: 0
      next: -1
      param3: 10 # Triggers an exit

250-ForestSiren:
  - name: Faron Trial Fi Questions Text
    type: textpatch
    index: 5
  - name: Remove first time trial Fi text
    type: flowpatch
    index: 6
    flow:
      next: Trial Questions Switch
  - name: Trial Questions Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 77 # Fi question text
      - 83 # End of Fi's text
  - name: Don't show Spirit Vessel UI early
    type: flowpatch
    index: 5
    flow:
      next: 6

299-Demo:
  - name: Skip setting sword itemflag
    type: flowpatch
    index: 2
    flow:
      next: 3

300-Mountain:
  - name: Skip over Zelda Dowsing
    type: flowpatch
    index: 281
    flow:
      next: -1
  - name: Patch in attentionmark to Nackle before bokos
    type: flowpatch
    index: 15
    flow:
      next: Add attentionmark to Nackle before bokos
  - name: Add attentionmark to Nackle before bokos
    type: attentionmark
    flow:
      next: -1

301-MountainD1:
  - name: remove ghirahim text before scaldera
    type: flowpatch
    index: 82
    flow:
      next: 48
  - name: give item after beating earth temple
    type: flowpatch
    index: 22
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: 20 # goes to beat ET story flag
      param3: 9
      param4: 0
      param5: 0
  - name: Prevent softlock on exit
    type: flowpatch
    index: 21
    flow:
      next: -1
  - name: Patch Ledd text before Gift
    type: flowpatch
    index: 7
    flow:
      next: Check if already given Gift
  - name: Check if already given Gift
    type: checksceneflag
    flow:
      checksceneflag: 45 # Received Ledd's Gift
    cases:
      - 90 # Continue as normal
      - Check if defeated Lizalfos
  - name: Check if defeated Lizalfos
    type: checksceneflag
    flow:
      checksceneflag: 2 # Double Lizalfos Defeated
    cases:
      - Show Attention Mark
      - 90 # Continue as normal
  - name: Show Attention Mark
    type: attentionmark
    flow:
      next: 89 # Give item
  - name: Goto Give sceneflag after Gift
    type: flowpatch
    index: 16
    flow:
      next: Give Gift sceneflag
  - name: Give Gift sceneflag
    type: setsceneflag
    flow:
      sceneindex: 14 # Earth Temple
      setsceneflag: 45
      next: 17 # post-Gift text
  - name: Always give same post-gift text
    type: flowpatch
    index: 91
    flow:
      next: 12


302-Anahori:
  - name: To Mitts Check
    type: flowpatch
    index: 0
    flow:
      next: Mitts Check
  - name: Mitts Check
    type: switchadd
    flow:
      subType: 6
      param2: 904 # Rando storyflag for digging mitts
      param3: 3
    cases:
      - 19 # normal text
      - Show No Mitts Text
  - name: No Mitts Text
    type: textadd
  - name: Show No Mitts Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 302
      param4: No Mitts Text

303-MountainF2:
  - name: skip over Water Basin dowsing
    type: flowpatch
    index: 128
    flow:
      param2: 668
  - name: skip over Water Basin dowsing
    type: flowpatch
    index: 289
    flow:
      param2: 134

304-MountainD2:
  - name: Give item before CS
    type: flowpatch
    index: 5
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Give Fire Sanctuary beaten story flag
      param3: 9
      param4: 0
      param5: 0
  - name: Give Fire Sanctuary beaten story flag
    type: setstoryflag
    flow:
      setstoryflag: 901 # Fire Sanctuary beaten story flag
      next: Give zone flag for load zone
  - name: Give zone flag for load zone
    type: setzoneflag
    flow:
      setzoneflag: 3
      next: -1

305-MountainF3:
  - name: Boko Base entry
    type: flowpatch
    index: 58
    flow:
      next: Show Boko Base Entry Question
  - name: Boko Base exit
    type: flowpatch
    index: 72
    flow:
      next: Show Boko Base Exit Question
  - name: Show Boko Base Exit Question
    type: flowadd
    flow:
      type: type1
      next: Boko Base Exit Switch
      param3: 302
      param4: Boko Base Exit Question
  - name: Boko Base Exit Question
    type: textadd
  - name: Boko Base Exit Switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Leave Boko Base # Yes
      - Show Declined Boko Base Offer Text # No (same as declined entry text)
  - name: Leave Boko Base
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0 # Entrance number for Eldin???
      param2: 0
      next: -1
      param3: 10 # Triggers an exit
  - name: Show Boko Base Entry Question
    type: flowadd
    flow:
      type: type1
      next: Boko Base Entry Switch
      param3: 302
      param4: Boko Base Entry Question
  - name: Boko Base Entry Question
    type: textadd
  - name: Boko Base Entry Switch
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 0
      param3: 2
    cases:
      - Entry into Boko Base # Yes
      - Show Declined Boko Base Offer Text # No
  - name: Declined Boko Base Offer Text
    type: textadd
  - name: Show Declined Boko Base Offer Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 302
      param4: Declined Boko Base Offer Text
  - name: Entry into Boko Base
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0 # Entrance number for Boko Base
      param2: 0
      next: -1
      param3: 10 # Triggers an exit
  - name: Talking to Plats in Boko Base Prison
    type: flowpatch
    index: 1
    flow:
      next: Check if received Plats' Gift
  - name: Check if received Plats' Gift
    type: switchadd
    flow:
      type: switch
      subType: 6
      param2: 177
      param3: 3
    cases:
      - Show Post Plats' Gift text # True
      - 2 # False
  - name: Post Plats' Gift text
    type: textadd
  - name: Show Post Plats' Gift text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 302
      param4: Post Plats' Gift text
  - name: Cut off Plats' text to give item
    type: flowpatch
    index: 2
    flow:
      next: Plats' Gift
  - name: Plats' Gift
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: 39
      param3: 9
  - name: Fix Plats text in hot cave
    type: flowpatch
    index: 25
    flow:
      next: 36
  - name: Go to Eldin SotH item
    type: flowpatch
    index: 28
    flow:
      next: Give item after Eldin SotH CS
  - name: Give item after Eldin SotH CS
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: -1
      param3: 9
  - name: Remove Fire Dragon's lore text after SotH item
    type: flowpatch
    index: 46
    flow:
      next: 47
  - name: Don't act differently when both other Dragons are already met
    type: flowpatch
    index: 31
    flow: {}
    cases:
      - 57
      - 57

399-Demo:
  - name: Skip setting sword itemflag
    type: flowpatch
    index: 0
    flow:
      next: 1

400-Desert:
  - name: Give item at end of LMF
    type: flowpatch
    index: 283
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Set storyflag for end of LMF item
      param3: 9
      param4: 0
      param5: 0
  - name: Set storyflag for end of LMF item
    type: setstoryflag
    flow:
      setstoryflag: 935
      next: -1
  - name: Fix Hook Beetle check # the robot doesn't give the item after harp
    type: flowpatch
    index: 39
    flow:
      next: 5
  - name: skip over Zelda dowsing
    type: flowpatch
    index: 133
    flow:
      next: -1

401-DesertD2:
  - name: remove skipper text after opening mast
    type: flowpatch
    index: 25
    flow:
      next: 50
  - name: give item after beating sandship
    type: flowpatch
    index: 45
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: Give Sandship beaten story flag
      param3: 9
      param4: 0
      param5: 0
  - name: Give Sandship beaten story flag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 15 # Sandship beaten story flag
      next: Give rando Tentalus Defeated storyflag
      param3: 0
  - name: Give rando Tentalus Defeated storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 933 # set defeat tentalus storyflag
      next: Give SSH crest zoneflag
      param3: 0
  - name: Give SSH crest zoneflag
    type: setzoneflag
    flow:
      setzoneflag: 3
      next: -1
  - name: Fi text text to leave dungeon
    type: textadd
    textboxtype: 2
  - name: Fi trigger to leave
    type: entryadd
    entry:
      name: "401_18"
      value: Fi text to leave
  - name: Fi text to leave
    type: flowadd
    flow:
      type: type1
      next: set tentalus defeated storyflag
      param3: 171
      param4: 57
  - name: set tentalus defeated storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 933 # tentalus defeated
      next: Leave dungeon trigger
      param3: 0
  - name: Leave dungeon trigger
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 1 # exit
      param2: 0 # current room
      next: -1
      param3: 10
  - name: Remove opening the map after saving the crew
    type: flowpatch
    index: 43
    flow:
      next: 28

402-DesertF2:
  - name: Override Skipper check for first time conversation
    type: flowpatch
    index: 2
    flow:
      next: 150 # Check for SSH visible flag
  - name: Never ask player to go inside shark mouth for ship dowsing
    type: flowpatch
    index: 17
    flow:
      next: 276

404-DesertF3:
  - name: Don't act when both other Dragons are already met
    type: flowpatch
    index: 21
    flow: {}
    cases:
      - 79
      - 79
  - name: Set story flags from skipped cutscene
    type: flowpatch
    index: 165
    flow:
      next: Set when Thunder Dragon teaches SotH part story flag
  - name: Set when Thunder Dragon teaches SotH part story flag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 462 # Set when Thunder Dragon teaches SotH part story flag
      next: Thunder Dragon teaches SotH part story flag
      param3: 0
  - name: Thunder Dragon teaches SotH part story flag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 21 # Thunder Dragon teaches SotH part story flag
      next: 90
      param3: 0
  - name: Go to item
    type: flowpatch
    index: 139
    flow:
      next: give item after Healing Thunderdragon
  - name: give item after Healing Thunderdragon
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: -1
      param3: 9
  - name: Shorten Golo Text
    type: flowpatch
    index: 108
    cases:
      - 123
      - Show Attention Mark
  - name: Show Attention Mark
    type: attentionmark
    flow:
      next: 128

406-TrolleyRace:
  - name: Always allow Minecart minigame
    type: flowpatch
    index: 26
    cases:
      - Check if already gotten minecart reward
      - Check if already gotten minecart reward
  - name: Check if already gotten minecart reward
    type: checkstoryflag
    flow:
      checkstoryflag: 667 # Storyflag set after getting minecart reward
    cases:
      - 100 # Continue as normal
      - Show Attention Mark
  - name: Show Attention Mark
    type: attentionmark
    flow:
      next: 100

  - name: Rickety Coaster Guaranteed Win Reward Choice Text
    type: textadd
  - name: Rickety Coaster Guaranteed Win Reward Choice Start
    onlyif: minigame_difficulty == guaranteed_win
    type: flowpatch
    index: 122
    flow:
      next: Show Rickety Coaster Guaranteed Win Reward Choice Text
  - name: Show Rickety Coaster Guaranteed Win Reward Choice Text
    type: flowadd
    flow:
      type: type1
      next: Show Rickety Coaster Guaranteed Win Reward Choice Switch
      param3: 3
      param4: Rickety Coaster Guaranteed Win Reward Choice Text
  - name: Show Rickety Coaster Guaranteed Win Reward Choice Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 0
    cases:
      - 76 # Rare Treasure
      - 6 # Uncommon Treasure
      - 5 # 20 Rupees

460-RairyuMinigame:
  - name: Avoid Boss rush Entry
    type: entryadd
    entry:
      name: "460_70"
      value: display Thank you text
  - name: Thunderdragon Thank you text
    type: textadd
  - name: display Thank you text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 115
      param4: Thunderdragon Thank you text

499-Demo:
  - name: Skip setting sword itemflag
    type: flowpatch
    index: 6
    flow:
      next: 7

500-CenterField:
  - name: to SG intro cs storyflag
    type: flowpatch
    index: 114
    flow:
      next: Set SG intro in Groose cs
  - name: Set SG intro in Groose cs
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 137
      next: -1
      param3: 0
  - name: Zelda dowsing in Key Piece
    type: flowpatch
    index: 495
    flow:
      next: 492

  # Groosenator
  - name: Always offer Groosenator choices
    type: flowpatch
    index: 78
    flow: {}
    cases:
      - 194
      - 194
  # Add FFW as a fling option
  - name: First Groosenator Choice Text
    type: textpatch
    index: 100
  - name: Goto Custom First Groosenator Choice Switch
    type: flowpatch
    index: 194
    flow:
      next: Custom First Groosenator Choice Switch
  - name: Custom First Groosenator Choice Switch
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 2
      param4: 4 # number of choices
    cases:
      - 196 # The Sky!
      - 198 # The Surface.
      - 79  # Flooded Faron Woods
      - 200 # Never mind!

  - name: Groosenator can't fling text
    type: textadd
  - name: Show Groosenator can't fling Text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 188
      param4: Groosenator can't fling text

  # Skydiving entrance requirement check
  - name: Access requirement for Skydiving choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 209
    flow:
      next: Check if previously landed on Fun Fun Island for Skydiving
  - name: Check if previously landed on Fun Fun Island for Skydiving
    type: checkstoryflag
    flow:
      checkstoryflag: 281 # Has landed on Fun Fun Island before
    cases:
      - 204 # true
      - Don't fling for Skydiving # false
  - name: Don't fling for Skydiving
    type: unsetzoneflag
    flow:
      unsetzoneflag: 1
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

  # Bug Hunting entrance requirement check
  - name: Access requirement for Bug Hunting choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 202
    flow:
      next: Check if previously accessed Inside the Thunderhead for Bug Hunting
  - name: Check if previously accessed Inside the Thunderhead for Bug Hunting
    type: checkstoryflag
    flow:
      checkstoryflag: 379 # Has entered Inside the Thunderhead for the first time
    cases:
      - 204 # true
      - Don't fling for Bug Hunting # false
  - name: Don't fling for Bug Hunting
    type: unsetzoneflag
    flow:
      unsetzoneflag: 2
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

  # Cutting entrance requirement check
  - name: Access requirement for Cutting choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 203
    flow:
      next: Check if previously landed on Bamboo Island for Cutting
  - name: Check if previously landed on Bamboo Island for Cutting
    type: checkstoryflag
    flow:
      checkstoryflag: 284 # Has landed on Bamboo Island before
    cases:
      - 204 # true
      - Don't fling for Cutting # false
  - name: Don't fling for Cutting
    type: unsetzoneflag
    flow:
      unsetzoneflag: 3
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

  # Shooting entrance requirement check
  - name: Access requirement for Shooting choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 205
    flow:
      next: Check if previously spoken to Fledge about Pumpkin Pull
  - name: Check if previously spoken to Fledge about Pumpkin Pull
    type: checkstoryflag
    flow:
      checkstoryflag: 400 # Talked to Fledge about Pumpkin Pull
    cases:
      - 204 # true
      - Don't fling for Shooting # false
  - name: Don't fling for Shooting
    type: unsetzoneflag
    flow:
      unsetzoneflag: 4
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

  # Lightning Round entrance requirement check
  - name: Access requirement for Lightning Round choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 206
    flow:
      next: Check if previously spoken to Lanayru about Lightning Round
  - name: Check if previously spoken to Lanayru about Lightning Round
    type: checkstoryflag
    flow:
      # TODO: replace with Lightning Round flag once that's added back to rando
      checkstoryflag: 462 # Given Life Tree Fruit to Thunder Dragon
    cases:
      - 204 # true
      - Don't fling for Lightning Round # false
  - name: Don't fling for Lightning Round
    type: unsetzoneflag
    flow:
      unsetzoneflag: 5
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

  # Thrill Digger entrance requirement check
  - name: Access requirement for Thrill Digger choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 207
    flow:
      next: Check if previously walked past Thrill Digger cave entrance
  - name: Check if previously walked past Thrill Digger cave entrance
    type: checkstoryflag
    flow:
      checkstoryflag: 1076 # Walked past Thrill Digger cave entrance
    cases:
      - 204 # true
      - Don't fling for Thrill Digger # false
  - name: Don't fling for Thrill Digger
    type: unsetzoneflag
    flow:
      unsetzoneflag: 6
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

  # Rickety Coaster entrance requirement check
  - name: Access requirement for Rickety Coaster choice
    onlyif: unlock_all_groosenator_destinations == off
    type: flowpatch
    index: 208
    flow:
      next: Check if previously spoken to Gortram about Rickety Coaster
  - name: Check if previously spoken to Gortram about Rickety Coaster
    type: checkstoryflag
    flow:
      checkstoryflag: 274 # Talked to Gortram about Rickety Coaster
    cases:
      - 204 # true
      - Don't fling for Rickety Coaster # false
  - name: Don't fling for Rickety Coaster
    type: unsetzoneflag
    flow:
      unsetzoneflag: 7
      sceneindex: 10 # Sealed Grounds scene index
      next: Show Groosenator can't fling Text

501-Inpa:
  - name: Patch start of The Old One text
    type: flowpatch
    index: 1
    flow: {}
    cases:
      - Check for Harp
      - Check for Harp
  - name: Check for Harp
    type: checkstoryflag
    flow:
      checkstoryflag: 9 # Has harp
    cases:
      - Check if already Received Item
      - 132 # Continue as normal
  - name: Check if already Received Item
    type: checksceneflag
    flow:
      checksceneflag: 29
    cases:
      - 132 # Continue as normal
      - Show Attention Mark
  - name: Show Attention Mark
    type: attentionmark
    flow:
      next: 47 # Set camera
  - name: Go from Set Camera to make Player Walk
    type: flowpatch
    index: 47
    flow:
      next: 19 # Make player walk towards The Old One
  - name: Start Harp Tutorial after Walking
    type: flowpatch
    index: 19
    flow:
      next: 44 # The Old One starts talking about the Harp
  # This one only gets hit if we're skipping the harp playing
  - name: Set flag for obtaining Song from the Old One
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 29 # obtained item scene flag
      param2: 2
      next: 267 # Give the item without going through the tutorial
      param3: 2
  - name: Skip Harp Tutorial if setting is on
    onlyif: skip_harp_playing == on
    type: flowpatch
    index: 44
    flow:
      next: Set flag for obtaining Song from the Old One
  - name: The Old One skip harp playing text
    type: textpatch
    index: 112
  - name: Don't raise the Gate of Time afterwards
    type: flowpatch
    index: 268
    flow:
      next: Unset Watched Groose Cutscene Storyflag
  # Prevents you being locked into playing the harp if you re-enter
  - name: Unset Watched Groose Cutscene Storyflag
    type: setstoryflag
    flow:
      setstoryflag: 135 # Watch Groose Pre-Harp Tutorial Cutscene
      param3: 1 # actually unset the flag
      next: -1

502-CenterFieldBack:
  - name: Zelda's Cutscene, give item from impa # this is overriding a set sceneflag, which is not needed anymore
    type: flowpatch
    index: 17
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 3 # item
      next: 16
      param3: 9
      param4: 0
      param5: 0
  - name: Yeet TMS Cutscene
    type: flowpatch
    index: 16
    flow:
      next: Give watched TMS Cutscene storyflag
  - name: Give watched TMS Cutscene storyflag
    type: flowadd
    flow:
      type: type3
      subType: 0
      param1: 0
      param2: 350 # TMS watched story flag
      next: -1
      param3: 0
  - name: Patch Fi text before Demise
    onlyif: skip_demise == on
    type: textpatch
    index: 23
  - name: Patch Fi text before Demise 2
    onlyif: skip_demise == on
    type: textpatch
    index: 25
  - name: Impa Complete Triforce text
    type: textadd
  - name: Show Triforce text
    type: flowadd
    flow:
      type: type1
      next: -1
      param3: 302
      param4: Impa Complete Triforce text
  - name: Check for Triforces
    type: entryadd
    entry:
      name: "502_20"
      value: Show Triforce text

  # - name: Raise GoT Entry
  #   type: entryadd
  #   entry:
  #     name: "502_21"
  #     value: Raise GoT
  # - name: Raise GoT
  #   type: setstoryflag
  #   flow:
  #     setstoryflag: 340 # Raise GoT
  #     next: Set imp2 beat storyflag
  # - name: Set imp2 beat storyflag
  #   type: setstoryflag
  #   flow:
  #     setstoryflag: 132 # Beat imp2
  #     next: -1

503-Goron:
  - name: To Bomb Bag Check I # when you don't have bow
    type: flowpatch
    index: 255
    flow:
      next: Bomb Bag Check I 1
  - name: Bomb Bag Check I 1
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 92 # Bomb Bag itemflag
      param2: 1 # check it's set
      next: Bomb Bag Check I 2
      param3: 23 # for checking a itemflag
  - name: Bomb Bag Check I 2
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 7 # use result from previous check
    cases:
      - 122 # true, continue with bomb as drawing quest
      - 224 # false, go to random select
  - name: To Bomb Bag Check II # when you do have bow
    type: flowpatch
    index: 259
    flow:
      next: Bomb Bag Check II 1
  - name: Bomb Bag Check II 1
    type: flowadd
    flow:
      type: type3
      subType: 1
      param1: 92 # Bomb Bag itemflag
      param2: 1 # check it's set
      next: Bomb Bag Check II 2
      param3: 23 # for checking a itemflag
  - name: Bomb Bag Check II 2
    type: switchadd
    flow:
      subType: 6
      param2: 0
      param3: 7 # use result from previous check
    cases:
      - 116 # true, continue with bomb as drawing quest
      - 261 # false, go to random select

599-Demo:
  - name: Skip setting sword itemflag
    type: flowpatch
    index: 6
    flow:
      next: 7
